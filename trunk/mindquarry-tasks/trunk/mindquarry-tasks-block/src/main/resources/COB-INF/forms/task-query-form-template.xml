<html xmlns:ft="http://apache.org/cocoon/forms/1.0#template"
	xmlns:fi="http://apache.org/cocoon/forms/1.0#instance"
	xmlns:jx="http://apache.org/cocoon/templates/jx/1.0">

	<jx:import
		uri="resource://org/apache/cocoon/forms/generation/jx-macros.xml" />

	<head>
		<title>Task Query Editor</title>
	</head>
	<body>
		<ft:form-template
			action="query.#{$cocoon/continuation/id}.continue" method="POST"
			ajax="true">
			
			<h1>Create Filter</h1>
			
			<div class="nifty">
				<ft:group id="queryBuilder">
					<div>
						<ft:widget id="aggregator" />
						<ft:widget id="addPart" />
					</div>
					<ft:repeater id="parts"
						xmlns:ft="http://apache.org/cocoon/forms/1.0#template">
						<table>
							<tbody>
								<ft:repeater-rows>
									<tr
										class="forms-row-${repeaterLoop.index % 2}">
										<td>
											<ft:widget id="field" />
										</td>
										<td>
											<ft:widget id="selector" />
										</td>
										<td>
											<ft:widget id="value" />
										</td>
										<td>
											<ft:widget id="delete" />
										</td>
									</tr>
								</ft:repeater-rows>
							</tbody>
						</table>
					</ft:repeater>
				</ft:group>
							
				<div class="actions">
					<ft:group id="queryBuilder">
						<ft:widget-label id="queryName" />
						<ft:widget id="queryName" />
					</ft:group>
				</div>
				
				<div class="actions">
					<ft:widget id="executeQuery" />
					<ft:group id="queryBuilder">
						<ft:widget id="saveQuery" />
					</ft:group>
				</div>
			</div>
			
			<div class="nifty">
				<ft:repeater id="results"
					xmlns:ft="http://apache.org/cocoon/forms/1.0#template">
						<table class="task-list">
							<tr><th>Task</th><th>Status</th></tr>
							
							<ft:repeater-rows>
								<tr class="highlight">
									<td>
										<img class="task_status"/>
										
										<!-- needed for link to real task view -->
										<ft:widget id="resultLink">
											<fi:styling styling="link" />
										</ft:widget>
										<ft:widget id="resultTitle">
											<fi:styling styling="linkcontent"/>
										</ft:widget>
										<br/>
										
										<ft:widget id="resultSummary" />
									</td>
									
									<td class="task_status">
										<ft:widget id="resultStatus" />
									</td>								
								</tr>
							</ft:repeater-rows>
						</table>
				</ft:repeater>
			</div>
		</ft:form-template>
	</body>
</html>
