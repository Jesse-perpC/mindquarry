<df:datatype id="dependencies" position="7"
	xmlns:fd="http://apache.org/cocoon/forms/1.0#definition"
	xmlns:ft="http://apache.org/cocoon/forms/1.0#template"
	xmlns:jx="http://apache.org/cocoon/templates/jx/1.0"
	xmlns:fi="http://apache.org/cocoon/forms/1.0#instance"
	xmlns:df="http://mindquarry.com/ns/xml/ductforms">
	<fd:repeater>
		<fd:datatype base="boolean" />
		<fd:label>Dependencies</fd:label>
		<fd:hint>This tasks depends on</fd:hint>
		<fd:help>
			Use this field for setting task relationships
		</fd:help>
		<fd:widgets>
			<fd:field id="dependencytask">
				<fd:datatype base="string" />
				<fd:selection-list src="block:tasks:/{teamspace}/lists/form.xml" cache="request">
				</fd:selection-list>
				<!--<fd:selection-list>
					<fd:item value="1"><fd:label>One</fd:label></fd:item>
					<fd:item value="2"><fd:label>Two</fd:label></fd:item>
				</fd:selection-list>-->
				<fd:label>Task</fd:label>
			</fd:field>
			<fd:field id="dependencyrole">
				<fd:datatype base="string" />
				<fd:label>Role</fd:label>
			</fd:field>
		<fd:row-action id="delete" command="delete">
			<fd:label>Remove</fd:label>
			<fd:hint>Remove a dependency that is no longer relevant to this task</fd:hint>
		</fd:row-action>
		</fd:widgets>
		<fd:attributes>
			<fd:attribute name="related" value="dependenciesadd"/>
		</fd:attributes>
	</fd:repeater>
	<fd:repeater-action id="add" command="add-row">
		<fd:label>Add Dependency</fd:label>
	</fd:repeater-action>
	
	
	<ft:repeater>
		<div class="repeater">
			<fi:label class="hidden">Dependencies</fi:label>
			<jx:choose>
				<jx:when test="${repeater.getSize() == 0}">
					<p>There are no dependencies assigned to this task</p>
				</jx:when>
				<jx:otherwise>
					<table>
						<tbody>
								<tr>
									<th class="dependencytask">
										<ft:repeater-widget-label widget-id="dependencytask" />
									</th>
									<th class="dependencyrole">
										<ft:repeater-widget-label widget-id="dependencyrole" />
									</th>
								</tr>
								<ft:repeater-rows>
									<tr class="forms-row-${repeaterLoop.index % 2}">
										<td class="dependencytask">
											<ft:widget id="dependencytask">
												<fi:styling autoactive="true" />
												<!--
												<fi:styling list-type="buttons"/>
												-->
											</ft:widget>
										</td>
										<td class="dependencyrole">
											<ft:widget id="dependencyrole" />
											<ft:widget id="delete"/>
										</td>
									</tr>
							</ft:repeater-rows>
						</tbody>
					</table>
				</jx:otherwise>
			</jx:choose>
			<ft:widget id="../dependenciesadd"/>
		</div>
	</ft:repeater>
	
	 
</df:datatype>